{% extends 'base.html' %}
{% load lottery_extras %}

{% block title %}ë‹¹ì²¨ í™•ì¸{% endblock %}

{% block content %}
<div class="d-flex justify-content-between align-items-center mb-4">
    <h2>ë‹¹ì²¨ í™•ì¸</h2>
    <a href="{% url 'lottery:my_tickets' %}" class="btn btn-outline-primary">ëª¨ë“  ë³µê¶Œ ë³´ê¸°</a>
</div>

{% if winning_tickets %}
<div class="alert alert-success">
    <h4 class="alert-heading">ğŸ‰ ë‹¹ì²¨ì„ ì¶•í•˜í•©ë‹ˆë‹¤!</h4>
    <p>{{ winning_tickets|length }}ì¥ì˜ ë³µê¶Œì´ ë‹¹ì²¨ë˜ì—ˆìŠµë‹ˆë‹¤. ì´ ìƒê¸ˆ <strong>â‚©{{ total_winnings }}</strong></p>
</div>

<div class="row">
    {% for ticket in winning_tickets %}
    <div class="col-md-6 mb-3">
        <div class="card border-success">
            <div class="card-header bg-success text-white">
                <h5 class="mb-0">ğŸ† ë‹¹ì²¨ ë³µê¶Œ</h5>
            </div>
            <div class="card-body">
                <p><strong>ë³µê¶Œ ìœ í˜•:</strong>{{ ticket.lottery_draw.lottery_type.name }}</p>
                <p><strong>ë³µê¶Œ ë²ˆí˜¸:</strong>{{ ticket.ticket_number }}</p>
                <p><strong>íšŒì°¨:</strong>{{ ticket.lottery_draw.draw_number }}</p>
                <p><strong>êµ¬ë§¤ ì‹œê°„:</strong>{{ ticket.purchase_time|date:"Y-m-d H:i" }}</p>
                
                <div class="row">
                    <div class="col-6">
                        <small class="text-muted">ì„ íƒí•œ ë²ˆí˜¸</small>
                        <div>
                            {% for number in ticket.selected_numbers|split:"," %}
                            <span class="lottery-number">{{ number }}</span>
                            {% endfor %}
                        </div>
                    </div>
                    <div class="col-6">
                        <small class="text-muted">ë‹¹ì²¨ ë²ˆí˜¸</small>
                        <div>
                            {% for number in ticket.lottery_draw.winning_numbers|split:"," %}
                            <span class="lottery-number winning-number">{{ number }}</span>
                            {% endfor %}
                        </div>
                    </div>
                </div>
                
                <div class="alert alert-success mt-3">
                    <strong>ë‹¹ì²¨ ê¸ˆì•¡: â‚©{{ ticket.winning_amount }}</strong>
                </div>
                
                {% if not ticket.is_claimed %}
                <div class="d-grid">
                    <a href="{% url 'lottery:claim_prize' ticket.id %}" class="btn btn-success">ì¦‰ì‹œ ìˆ˜ë ¹</a>
                </div>
                {% else %}
                <div class="alert alert-info">
                    <span class="badge bg-success">ìˆ˜ë ¹ ì™„ë£Œ</span>
                    ìƒê¸ˆì´ ê³„ì • ì”ì•¡ì— ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤
                </div>
                {% endif %}
            </div>
        </div>
    </div>
    {% endfor %}
</div>

{% else %}
<div class="text-center">
    <div class="alert alert-info">
        <h4>ë‹¹ì²¨ëœ ë³µê¶Œì´ ì—†ìŠµë‹ˆë‹¤</h4>
        <p>ê³„ì† ë…¸ë ¥í•˜ì‹œë©´ ì¢‹ì€ ìš´ì´ ì˜¬ ê±°ì˜ˆìš”!</p>
        <a href="{% url 'lottery:lottery_list' %}" class="btn btn-primary">ë³µê¶Œ ê³„ì† êµ¬ë§¤</a>
    </div>
</div>
{% endif %}

<div class="mt-4">
    <div class="card">
        <div class="card-header">
            <h5>ë‹¹ì²¨ ì•ˆë‚´</h5>
        </div>
        <div class="card-body">
            <ul class="mb-0">
                <li>3ê°œ ë²ˆí˜¸ ì¼ì¹˜: ë³µê¶Œ ê°€ê²©ì˜ 10ë°°</li>
                <li>4ê°œ ë²ˆí˜¸ ì¼ì¹˜: ë³µê¶Œ ê°€ê²©ì˜ 50ë°°</li>
                <li>5ê°œ ë²ˆí˜¸ ì¼ì¹˜: ë³µê¶Œ ê°€ê²©ì˜ 200ë°°</li>
                <li>6ê°œ ì´ìƒ ë²ˆí˜¸ ì¼ì¹˜: ë³µê¶Œ ê°€ê²©ì˜ 1000ë°°</li>
                <li>ë‹¹ì²¨ ìƒê¸ˆì€ ìˆ˜ë ¹ í›„ ì¦‰ì‹œ ê³„ì • ì”ì•¡ì— ì¶”ê°€ë©ë‹ˆë‹¤</li>
            </ul>
        </div>
    </div>
</div>
{% endblock %}
